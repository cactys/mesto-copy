(()=>{"use strict";class e{constructor(e,t,r){this._title=e.name,this._image=e.link,this._cardSelector=t,this._handleOpenPopup=r}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}generateCard(){return this._element=this._getTemplate(),this._cardImage=this._element.querySelector(".card__image"),this._cardTitle=this._element.querySelector(".card__name"),this._buttonLike=this._element.querySelector(".card__like-button"),this._buttonDelete=this._element.querySelector(".card__trach-icon"),this._cardImage.src=this._image,this._cardImage.alt=this._title,this._cardTitle.textContent=this._title,this._setEventListeners(),this._element}_handleCardClick=()=>{this._handleOpenPopup(this._title,this._image)};_handleDeleteCard=()=>{this._element.remove(),this._element=null};_handleLikeCard=()=>{this._buttonLike.classList.toggle("card__like-button_active")};_setEventListeners(){this._cardImage.addEventListener("click",this._handleCardClick),this._buttonDelete.addEventListener("click",this._handleDeleteCard),this._buttonLike.addEventListener("click",this._handleLikeCard)}}class t{constructor(e,t){this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this._inputErrorClass=e.inputErrorClass,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._errorClass=e.errorClass,this._formElement=t,this._buttonElement=this._formElement.querySelector(this._submitButtonSelector),this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector))}_showInputError=e=>{const t=this._formElement.querySelector(`.${e.id}-error`);e.classList.add(this._inputErrorClass),t.classList.add(this._errorClass),t.textContent=e.validationMessage};_hideInputError=e=>{const t=this._formElement.querySelector(`.${e.id}-error`);e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass),t.textContent=""};_hasInvalidInput=()=>this._inputList.some((e=>!e.validity.valid));_checkInputValidity=e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e)};_setEventListeners=()=>{this.toggleButtonState(),this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))};toggleButtonState=()=>{this._hasInvalidInput()?(this._buttonElement.disabled=!0,this._buttonElement.classList.add(this._inactiveButtonClass)):(this._buttonElement.disabled=!1,this._buttonElement.classList.remove(this._inactiveButtonClass))};enableValidation=()=>{this._setEventListeners()};resetError=()=>{this._inputList.forEach((e=>{this._hideInputError(e)})),this.toggleButtonState()}}const r={formSelector:".form",inputSelector:".form__input",inputErrorClass:"form__input_inactive",submitButtonSelector:".form__submit",inactiveButtonClass:"form__submit_disabled",errorClass:"form__input-error_active"},n=document.querySelectorAll(".popup"),o=document.querySelector(".popup_type_profile"),s=document.querySelector(".popup_type_add-photo"),i=document.querySelector(".profile__edit-button"),l=document.querySelector(".profile__add-button"),a=document.querySelector(".profile__title"),c=document.querySelector(".profile__subtitle"),d=document.querySelector(".cards"),u=document.querySelector(".popup_type_photo"),_=document.querySelector(".photo-container__photo"),p=document.querySelector(".photo-container__photo-title"),h=document.querySelector(".form_edit-profile"),m=h.querySelector(".form__input_profile-name"),v=h.querySelector(".form__input_profile-job"),y=document.querySelector(".form_add-photo"),S=y.querySelector(".form__input_photo-title"),E=y.querySelector(".form__input_photo-src"),f=new t(r,h);f.enableValidation();const L=new t(r,y);L.enableValidation();const b=t=>new e(t,".card-template",g).generateCard(),g=(e,t)=>{_.src=t,_.alt=e,p.textContent=e,k(u)},k=e=>{document.addEventListener("keydown",q),e.classList.add("popup_opened")},C=e=>{document.removeEventListener("keydown",q),e.classList.remove("popup_opened")},q=e=>{if("Escape"===e.key){const e=document.querySelector(".popup_opened");C(e)}};[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}].forEach((e=>{const t=b(e);d.append(t)})),y.addEventListener("submit",(()=>{const e={name:S.value,link:E.value},t=b(e);d.prepend(t),y.reset(),C(s),L.resetError()})),h.addEventListener("submit",(()=>{a.textContent=m.value,c.textContent=v.value,C(o)})),n.forEach((e=>{e.addEventListener("mousedown",(t=>{(t.target.classList.contains("popup_opened")||t.target.classList.contains("popup__close"))&&C(e)}))})),i.addEventListener("click",(()=>{m.value=a.textContent,v.value=c.textContent,f.toggleButtonState(),f.resetError(),k(o)})),l.addEventListener("click",(()=>{k(s)}))})();